package com.old.time.activitys;import android.app.Activity;import android.app.ProgressDialog;import android.content.Intent;import android.text.TextUtils;import android.view.View;import android.widget.Button;import android.widget.EditText;import com.lzy.okgo.model.HttpParams;import com.old.time.R;import com.old.time.beans.ResultBean;import com.old.time.beans.UserInfoBean;import com.old.time.constants.Constant;import com.old.time.okhttps.JsonCallBack;import com.old.time.okhttps.OkGoUtils;import com.old.time.postcard.PostCardActivity;import com.old.time.utils.ActivityUtils;import com.old.time.utils.UserLocalInfoUtils;import com.old.time.utils.StringUtils;import com.old.time.utils.UIHelper;public class UserLoginActivity extends BaseActivity {    private EditText input_phone, input_pass_word;    private Button btn_login;    /**     * 用户登录     *     * @param mContext     */    public static void startUserLoginActivity(Activity mContext) {        UserLocalInfoUtils.instance().setUserLogOut();        Intent intent = new Intent(mContext, UserLoginActivity.class);        ActivityUtils.startLoginActivity(mContext, intent);        ActivityUtils.finishActivity(mContext);    }    private ProgressDialog progressDialog;    /**     * 登陆     */    private void loginUser() {        String phoneStr = input_phone.getText().toString().trim();        String pasWord = input_pass_word.getText().toString().trim();        if (TextUtils.isEmpty(phoneStr)) {            UIHelper.ToastMessage(mContext, "请输入手机号");            return;        }        if (TextUtils.isEmpty(pasWord)) {            UIHelper.ToastMessage(mContext, "请输入密码");            return;        }        if (!StringUtils.isMobileNO(phoneStr)) {            UIHelper.ToastMessage(mContext, "请输入正确的手机号");            return;        }        progressDialog = UIHelper.showProgressMessageDialog(mContext, getString(R.string.please_wait));        HttpParams params = new HttpParams();        params.put("mobile", phoneStr);        params.put("pasWord", StringUtils.encodeByMD5(pasWord));        OkGoUtils.getInstance().postNetForData(params, Constant.USER_LOGIN, new JsonCallBack<ResultBean<UserInfoBean>>() {            @Override            public void onSuccess(ResultBean<UserInfoBean> mResultBean) {                UIHelper.dissmissProgressDialog(progressDialog);                if (mResultBean == null || mResultBean.data == null) {                    return;                }                UserLocalInfoUtils.instance().setmUserInfoBean(mResultBean.data);                PostCardActivity.startPostCardActivity(mContext);            }            @Override            public void onError(ResultBean<UserInfoBean> mResultBean) {                UIHelper.dissmissProgressDialog(progressDialog);                UIHelper.ToastMessage(mContext, mResultBean.msg);            }        });    }    @Override    protected void initView() {        input_phone = findViewById(R.id.input_phone);        input_pass_word = findViewById(R.id.input_pass_word);        btn_login = findViewById(R.id.btn_login);    }    @Override    protected void initEvent() {        super.initEvent();        btn_login.setOnClickListener(this);        findViewById(R.id.tv_pass_word).setOnClickListener(this);        findViewById(R.id.tv_user_register).setOnClickListener(this);    }    @Override    public void onClick(View view) {        super.onClick(view);        switch (view.getId()) {            case R.id.btn_login:                loginUser();                break;            case R.id.tv_user_register:                startUserRegister("0");                break;            case R.id.tv_pass_word:                startUserRegister("1");                break;        }    }    @Override    public void onBackPressed() {        ActivityUtils.finishLoginActivity(mContext);        super.onBackPressed();    }    @Override    public void back(View view) {        ActivityUtils.finishLoginActivity(mContext);    }    /**     * 进入注册页面     *     * @param mRegisterTag     */    private void startUserRegister(String mRegisterTag) {        String phoneStr = input_phone.getText().toString().trim();        UserRegisterActivity.startUserRegisterActivity(mContext, mRegisterTag, phoneStr);    }    @Override    protected int getLayoutID() {        return R.layout.activity_login;    }}